<section class="watch">
  <a href="/" class="back-link" style="display:inline-block;margin:6px 0 4px;color:#98a4c5;font-size:14px">← Kembali</a>

  <h1 class="watch-title" style="display:flex;align-items:center;gap:8px;margin:6px 0 10px">
    <span class="t" style="font-size:36px;font-weight:800;letter-spacing:.3px"><%= v.title %></span>
    <span class="badge-trailer" style="font-size:13px;font-weight:900;letter-spacing:.6px;padding:6px 10px;border-radius:12px;border:1px solid #2b356b;background:rgba(98,120,255,.12)">TRAILER</span>
  </h1>

  <!-- === ADS 300x250 (ATAS PLAYER) === -->
  <div class="ad-slot-top" style="border:1px solid #2b356b;border-radius:12px;padding:10px;text-align:center;color:#98a4c5;background:rgba(255,255,255,.03);margin:8px 0 12px">
    <div style="width:300px;height:250px;margin:0 auto">
      <script type="text/javascript">
        atOptions = {
          'key' : '831612669ba4d3f31de52735c46c39ee',
          'format' : 'iframe',
          'height' : 250,
          'width' : 300,
          'params' : {}
        };
      </script>
      <script type="text/javascript" src="//www.highperformanceformat.com/831612669ba4d3f31de52735c46c39ee/invoke.js"></script>
      <script type="text/javascript" src="//pl27783519.revenuecpmgate.com/fe/dc/72/fedc72b1ab53e76af36dadde9e58fdd4.js"></script>
      <script type="text/javascript" src="//pl27783551.revenuecpmgate.com/d6/d7/69/d6d7691b699381fedc7f28855c9aa3cf.js"></script>
    </div>
  </div>

  <!-- PLAYER -->
  <div class="player-shell"
       style="width:100%;max-width:360px;aspect-ratio:16/9;margin:0 auto 12px;border-radius:16px;overflow:hidden;box-shadow:0 0 24px rgba(0,0,0,.35);background:#000;">
    <video
      controls
      playsinline
      preload="metadata"
      controlsList="nodownload"
      disablePictureInPicture
      poster="<%= v.thumb_url || '/public/placeholder-thumb.jpg' %>"
      src="<%= v.url %>"
      style="width:100%;height:100%;background:#000;display:block;border-radius:16px;">
    </video>
  </div>

  <% if (v.fullUrl) { %>
    <div class="cta-wrap" style="display:flex;justify-content:center;margin:6px 0 8px">
      <a class="btn btn-primary"
         style="display:inline-flex;gap:8px;align-items:center;justify-content:center;padding:12px 16px;border-radius:12px;border:none;background:linear-gradient(90deg,#3a8ef6,#6f3afa);color:#fff;font-weight:700"
         href="<%= v.fullUrl %>" target="_blank" rel="noopener noreferrer">▶ Tonton FULL</a>
    </div>
  <% } %>

  <!-- === ADS 300x250 (BAWAH PLAYER) === -->
  <div class="ad-banner" style="max-width:680px;margin:16px auto 0;display:flex;flex-direction:column;gap:14px">
    <div class="ad-box" style="border:1px dashed #2b356b;border-radius:12px;padding:10px;text-align:center;color:#98a4c5;background:rgba(255,255,255,.03)">
      <div style="width:300px;height:250px;margin:0 auto">
        <script type="text/javascript">
          atOptions = {
            'key' : '831612669ba4d3f31de52735c46c39ee',
            'format' : 'iframe',
            'height' : 250,
            'width' : 300,
            'params' : {}
          };
        </script>
        <script type="text/javascript" src="//www.highperformanceformat.com/831612669ba4d3f31de52735c46c39ee/invoke.js"></script>
        <script type="text/javascript" src="//pl27783519.revenuecpmgate.com/fe/dc/72/fedc72b1ab53e76af36dadde9e58fdd4.js"></script>
        <script type="text/javascript" src="//pl27783551.revenuecpmgate.com/d6/d7/69/d6d7691b699381fedc7f28855c9aa3cf.js"></script>
      </div>
    </div>
  </div>

  <!-- ====== SHARE LINK (PALING BAWAH) ====== -->
  <div class="share-wrap" style="max-width:680px;margin:18px auto 28px;padding:12px;border:1px solid #2b356b;border-radius:12px;background:rgba(255,255,255,.03)">
    <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center">
      <input id="share-url" type="text" readonly
             value="<%= shareUrl %>"
             style="flex:1 1 260px;min-width:240px;border:1px solid #2b356b;background:#0e1530;color:#c6d0f5;border-radius:10px;padding:10px 12px;font-size:14px" />
      <button id="btn-copy" type="button"
              style="padding:10px 12px;border-radius:10px;border:1px solid #2b356b;background:#1b2a62;color:#fff;font-weight:700">
        Salin Link
      </button>
      <button id="btn-share" type="button"
              style="padding:10px 12px;border-radius:10px;border:1px solid #2b356b;background:#2b6ef6;color:#fff;font-weight:700">
        Share
      </button>
    </div>
    <small id="share-msg" style="display:block;margin-top:8px;color:#98a4c5"></small>

    <script>
      (function(){
        var url = document.getElementById('share-url').value || window.location.href;
        var $input = document.getElementById('share-url');
        var $copy  = document.getElementById('btn-copy');
        var $share = document.getElementById('btn-share');
        var $msg   = document.getElementById('share-msg');

        function flash(text){
          $msg.textContent = text;
          setTimeout(function(){ $msg.textContent=''; }, 1800);
        }

        $copy.addEventListener('click', function(){
          if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(url).then(function(){ flash('Link disalin.'); });
          } else {
            $input.select(); document.execCommand('copy'); flash('Link disalin.');
          }
        });

        $share.addEventListener('click', function(){
          if (navigator.share) {
            navigator.share({ title: document.title, text: 'Tonton ini di <%= site.title %>', url: url })
              .catch(function(){ /* user cancel */ });
          } else {
            $copy.click();
          }
        });
      })();
    </script>
  </div>
</section>
